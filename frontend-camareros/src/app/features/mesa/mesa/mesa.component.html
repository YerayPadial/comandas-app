<div class="min-h-screen bg-gray-50 p-4 flex flex-col items-center">
    <h2 class="text-2xl font-bold mb-6 text-center w-full">Mesa: {{ nombreMesa }}</h2>

    <!-- Categorías -->
    <div class="w-full flex flex-wrap justify-center gap-4 mb-8">
        <button *ngFor="let cat of categorias" (click)="categoriaSeleccionada = cat"
            class="min-w-[140px] py-4 px-2 rounded-xl font-bold text-lg shadow transition-all border-2 focus:outline-none"
            [ngClass]="categoriaSeleccionada === cat
        ? 'bg-blue-600 text-white border-blue-700 scale-105 shadow-lg'
        : 'bg-white text-gray-800 border-gray-300 hover:bg-blue-50'">
            {{ cat }}
        </button>
    </div>

    <!-- Productos -->
    <div *ngIf="loading()" class="text-center py-8 text-gray-500 w-full">Cargando productos...</div>

    <div *ngIf="!loading()" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 w-full">
        <button *ngFor="let prod of productosFiltrados" (click)="agregarProducto(prod)"
            class="w-full py-4 px-2 rounded-xl font-bold text-base bg-white shadow hover:bg-blue-100 transition-all flex flex-col items-center border-2 border-gray-200 relative"
            style="position: relative;">
            <!-- Botón restar -->
            <span
              *ngIf="comandaActual[prod.id]"
              (click)="restarProducto(prod, $event)"
              class="absolute top-2 left-2 bg-red-600 text-white p-1 rounded-full shadow cursor-pointer select-none z-10 flex items-center justify-center"
              title="Quitar uno"
            >
              <!-- Heroicons Minus Small SVG -->
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 12h12" />
              </svg>
            </span>

            <span>{{ prod.nombre }}</span>
            <span class="text-blue-700 text-lg mt-2 font-bold">{{ prod.precio | currency:'EUR' }}</span>
            <!-- Cantidad -->
            <span *ngIf="comandaActual[prod.id]"
                class="absolute top-2 right-2 bg-blue-600 text-white px-2 py-1 rounded-full shadow font-bold text-xs flex items-center justify-center z-10"
            >
                x{{ comandaActual[prod.id].cantidad }}
            </span>
        </button>
    </div>

    <!-- Botón Ver Comanda -->
    <button (click)="verComanda()" [disabled]="!tieneComanda"
        class="fixed bottom-4 right-4 left-4 md:left-auto md:right-8 bg-green-600 text-white px-8 py-4 rounded-full font-bold shadow-lg hover:bg-green-700 transition-all text-lg disabled:opacity-50"
        style="z-index:50">
        Ver Comanda
    </button>
</div>